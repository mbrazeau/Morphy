//
//  tui_charoptim.c
//  Morphy
//
//  Created by mbrazeau on 06/06/2016.
//
//

#include "morphy.h"
#include "tuimfy.h"

int num_matrices = 50;
int num_test_char = 1;
char* testmatrices[] = {
    (char*)"0402153-1-50-40-;",
    (char*)"4-24-330-11305-2;",
    (char*)"5-2-2504025-40-4;",
    (char*)"05--344-1000205-;",
    (char*)"0-253--03321-200;",
    (char*)"-5405-1555221-34;",
    (char*)"-02005-5-44554--;",
    (char*)"02--40--14454-40;",
    (char*)"0-25-1440333-142;",
    (char*)"43132525--4--4--;",
    (char*)"04-0-3133132--00;",
    (char*)"430-40-04125-344;",
    (char*)"2-43-3001544-343;",
    (char*)"44-3231002--52-5;",
    (char*)"3203300--325433-;",
    (char*)"4--5-51-1322321-;",
    (char*)"-51-250-40402-11;",
    (char*)"020115--5-554232;",
    (char*)"31101-221-1-5150;",
    (char*)"10-3011-331-110-;",
    (char*)"0025343345--252-;",
    (char*)"-010334-1243-314;",
    (char*)"1-324055-5132-0-;",
    (char*)"--5121543343431-;",
    (char*)"053-52103314--55;",
    (char*)"23532-11253-001-;",
    (char*)"-242-55-05244011;",
    (char*)"-330355233-131-5;",
    (char*)"03-0-3240-055250;",
    (char*)"4-5-33-4-3530333;",
    (char*)"40044--3-5153-1-;",
    (char*)"-25-3130152-2213;",
    (char*)"5-402053--532033;",
    (char*)"0401-40150--304-;",
    (char*)"21445-1444414-4-;",
    (char*)"-455-35135-0-3-2;",
    (char*)"31512-11301-5-1-;",
    (char*)"3122055--4-1215-;",
    (char*)"0-430-30303254--;",
    (char*)"002-31-311045-1-;",
    (char*)"1-4405-503454-35;",
    (char*)"03422--50555----;",
    (char*)"32-5155212--0554;",
    (char*)"-05301-10132452-;",
    (char*)"5315-35135-151--;",
    (char*)"323--220033-2333;",
    (char*)"-2054121--210221;",
    (char*)"-255--3-4411535-;",
    (char*)"2513-33-1253-542;",
    (char*)"-20330342--31035;"
};

int num_test_taxa = 12;
int num_test_topologies = 5;
char* testopologies[] = {
    (char*)"Tree1 = [&R] ((((1,2),((3,4),5)),(6,7)),((((8,9),10),(11,(12,13))),(14,(15,16))));",
    (char*)"Tree2 = [&R] ((((12,2),(7,16)),(5,4)),(((6,(9,10)),((((14,1),(13,11)),8),15)),3));",
    (char*)"Tree3 = [&R] (((8,4),10),(((5,(9,((6,14),(((11,3),7),2)))),((16,12),(13,15))),1));",
    (char*)"Tree4 = [&R] ((((7,2),(10,1)),((9,13),(6,5))),(((15,11),(12,8)),((3,16),(14,4))));",
    (char*)"Tree5 = [&R] (7,(2,(10,(1,(9,(13,(6,(5,(15,(11,(12,(8,(3,(16,(14,4)))))))))))))));"
};

void tui_test_lengths(tui_test_topol_t* ttopol)
{
    if (ttopol->tt_expected_length == ttopol->tt_measured_length) {
        dbg_ppass("expected and calcuated lengths matched");
    }
    else {
        if (ttopol->tt_measured_length > ttopol->tt_expected_length) {
            dbg_pfail("calculated length exceeds expected length");
        }
        else {
            dbg_pfail("calculated length is shorter than expected");
        }
    }
}

void tui_test_character_optimisation(void)
{
 

    
    
}